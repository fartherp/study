<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>k8s单机部署</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="a5uy" id="k8s单机部署">k8s单机部署</h1><hr><div class="md-section-divider"></div><h2 data-anchor-id="geym" id="关闭centos防火墙">关闭centos防火墙</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ld4x"><ol class="linenums"><li class="L0"><code><span class="pln">systemctl disable firewalld</span></code></li><li class="L1"><code><span class="pln">systemctl stop firewalld</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="t79n" id="安装etcd和k8s会自动安装docker">安装etcd和k8s（会自动安装docker）</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0ytk"><ol class="linenums"><li class="L0"><code><span class="pln">yum install </span><span class="pun">-</span><span class="pln">y etcd kubernetes</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="cgwv" id="修改配置">修改配置</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="seur"><ol class="linenums"><li class="L0"><code><span class="pln">vi </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">sysconfig</span><span class="pun">/</span><span class="pln">docker</span></code></li><li class="L1"><code><span class="pln">OPTIONS</span><span class="pun">=</span><span class="str">'--selinux-enabled=false --insecure-registry gcr.io'</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="nzxl" id="启动服务">启动服务</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0jov"><ol class="linenums"><li class="L0"><code><span class="pln">systemctl start etcd</span></code></li><li class="L1"><code><span class="pln">systemctl start docker</span></code></li><li class="L2"><code><span class="pln">systemctl start kube</span><span class="pun">-</span><span class="pln">apiserver</span></code></li><li class="L3"><code><span class="pln">systemctl start kube</span><span class="pun">-</span><span class="pln">controller</span><span class="pun">-</span><span class="pln">manager</span></code></li><li class="L4"><code><span class="pln">systemctl start kube</span><span class="pun">-</span><span class="pln">scheduler</span></code></li><li class="L5"><code><span class="pln">systemctl start kubelet</span></code></li><li class="L6"><code><span class="pln">systemctl start kube</span><span class="pun">-</span><span class="pln">proxy</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="2eyt" id="启动mysql">启动mysql</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="goqs"><ol class="linenums"><li class="L0"><code><span class="pln">kubectl create </span><span class="pun">-</span><span class="pln">f mysql</span><span class="pun">-</span><span class="pln">rc</span><span class="pun">.</span><span class="pln">yaml</span></code></li><li class="L1"><code><span class="pln">kubectl </span><span class="kwd">get</span><span class="pln"> rc</span></code></li><li class="L2"><code><span class="pln">kubectl </span><span class="kwd">get</span><span class="pln"> pods</span></code></li><li class="L3"><code><span class="pln">docker ps </span><span class="pun">|</span><span class="pln"> grep mysql</span></code></li><li class="L4"><code><span class="pln">kubectl create </span><span class="pun">-</span><span class="pln">f mysql</span><span class="pun">-</span><span class="pln">svc</span><span class="pun">.</span><span class="pln">yaml</span></code></li><li class="L5"><code><span class="pln">kubectl </span><span class="kwd">get</span><span class="pln"> svc</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="ylxg" id="启动tomcat">启动tomcat</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2pve"><ol class="linenums"><li class="L0"><code><span class="pln">kubectl create </span><span class="pun">-</span><span class="pln">f myweb</span><span class="pun">-</span><span class="pln">rc</span><span class="pun">.</span><span class="pln">yaml</span></code></li><li class="L1"><code><span class="pln">kubectl </span><span class="kwd">get</span><span class="pln"> pods</span></code></li><li class="L2"><code><span class="pln">kubectl create </span><span class="pun">-</span><span class="pln">f myweb</span><span class="pun">-</span><span class="pln">svc</span><span class="pun">.</span><span class="pln">yaml</span></code></li><li class="L3"><code><span class="pln">kubectl </span><span class="kwd">get</span><span class="pln"> services</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="0sei" id="访问页面">访问页面</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="qfha"><ol class="linenums"><li class="L0"><code><span class="pln">http</span><span class="pun">:</span><span class="com">//ip:30001/demo/</span></code></li></ol></pre></div>
</body>
</html>