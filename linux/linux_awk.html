<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>linux的awk</title>
</head>
<body>
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"><path id="MJMAIN-31" stroke-width="1" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJMAIN-2C" stroke-width="1" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></defs></svg></div><div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="9nt8" id="linux的awk">linux的awk</h1><hr><div class="md-section-divider"></div><h2 data-anchor-id="hk9z" id="显示最近登录的5个帐号信息">显示最近登录的5个帐号信息</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="x3bw"><ol class="linenums"><li class="L0"><code><span class="kwd">last</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">5</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="3oye" id="只是显示最近登录的5个帐号">只是显示最近登录的5个帐号</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ysrl"><ol class="linenums"><li class="L0"><code><span class="kwd">last</span><span class="pln"> </span><span class="pun">-</span><span class="pln">n </span><span class="lit">5</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> awk  </span><span class="str">'{print $1}'</span></code></li><li class="L1"><code><span class="pln">awk</span><span class="pun">工作流程是这样的：读入有</span><span class="str">'\n'</span><span class="pun">换行符分割的一条记录，然后将记录按指定的域分隔符划分域，填充域，</span><span class="pln">$0</span><span class="pun">则表示所有域,</span><span class="pln">$1</span><span class="pun">表示第一个域,</span><span class="pln">$n</span><span class="pun">表示第</span><span class="pln">n</span><span class="pun">个域。默认域分隔符是</span><span class="str">"空白键"</span><span class="pln"> </span><span class="pun">或</span><span class="pln"> </span><span class="str">"[tab]键"</span><span class="pun">,所以</span><span class="pln">$1</span><span class="pun">表示登录用户，</span><span class="pln">$3</span><span class="pun">表示登录用户</span><span class="pln">ip</span><span class="pun">,以此类推。</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="3kcx" id="只是显示etcpasswd的账户">只是显示/etc/passwd的账户</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3pyf"><ol class="linenums"><li class="L0"><code><span class="pln">cat </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">passwd </span><span class="pun">|</span><span class="pln">awk  </span><span class="pun">-</span><span class="pln">F </span><span class="str">':'</span><span class="pln">  </span><span class="str">'{print $1}'</span><span class="pln">  </span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="1es4" id="只是显示etcpasswd的账户和账户对应的shell而账户与shell之间以tab键分割">只是显示/etc/passwd的账户和账户对应的shell,而账户与shell之间以tab键分割</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="pqgv"><ol class="linenums"><li class="L0"><code><span class="pln">cat </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">passwd </span><span class="pun">|</span><span class="pln">awk  </span><span class="pun">-</span><span class="pln">F </span><span class="str">':'</span><span class="pln">  </span><span class="str">'{print $1"\t"$7}'</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="wz9q" id="只是显示etcpasswd的账户和账户对应的shell而账户与shell之间以逗号分割而且在所有行添加列名nameshell在最后一行添加bluebinnosh">只是显示/etc/passwd的账户和账户对应的shell,而账户与shell之间以逗号分割,而且在所有行添加列名name,shell,在最后一行添加"blue,/bin/nosh"</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="uk37"><ol class="linenums"><li class="L0"><code><span class="pln">cat </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">passwd </span><span class="pun">|</span><span class="pln">awk  </span><span class="pun">-</span><span class="pln">F </span><span class="str">':'</span><span class="pln">  </span><span class="str">'BEGIN {print "name,shell"}  {print $1","$7} END {print "blue,/bin/nosh"}'</span></code></li><li class="L1"><code><span class="pln">awk</span><span class="pun">工作流程是这样的：先执行</span><span class="pln">BEGING</span><span class="pun">，然后读取文件，读入有/</span><span class="pln">n</span><span class="pun">换行符分割的一条记录，然后将记录按指定的域分隔符划分域，填充域，</span><span class="pln">$0</span><span class="pun">则表示所有域,</span><span class="pln">$1</span><span class="pun">表示第一个域,</span><span class="pln">$n</span><span class="pun">表示第</span><span class="pln">n</span><span class="pun">个域,随后开始执行模式所对应的动作</span><span class="pln">action</span><span class="pun">。接着开始读入第二条记录······直到所有的记录都读完，最后执行</span><span class="kwd">END</span><span class="pun">操作。</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="ji4z" id="搜索etcpasswd有root关键字的所有行">搜索/etc/passwd有root关键字的所有行</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="4ico"><ol class="linenums"><li class="L0"><code><span class="pln">awk </span><span class="pun">-</span><span class="pln">F</span><span class="pun">:</span><span class="pln"> </span><span class="str">'/root/'</span><span class="pln"> </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">passwd</span></code></li><li class="L1"><code><span class="pun">这种是</span><span class="pln">pattern</span><span class="pun">的使用示例，匹配了</span><span class="pln">pattern</span><span class="pun">(这里是</span><span class="pln">root</span><span class="pun">)的行才会执行</span><span class="pln">action</span><span class="pun">(没有指定</span><span class="pln">action</span><span class="pun">，默认输出每行的内容)。</span></code></li><li class="L2"><code><span class="pun">搜索支持正则，例如找</span><span class="pln">root</span><span class="pun">开头的:</span><span class="pln"> awk </span><span class="pun">-</span><span class="pln">F</span><span class="pun">:</span><span class="pln"> </span><span class="str">'/^root/'</span><span class="pln"> </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">passwd</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="45aj" id="搜索etcpasswd有root关键字的所有行并显示对应的shell">搜索/etc/passwd有root关键字的所有行，并显示对应的shell</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="xyb9"><ol class="linenums"><li class="L0"><code><span class="pln">awk </span><span class="pun">-</span><span class="pln">F</span><span class="pun">:</span><span class="pln"> </span><span class="str">'/root/{print $7}'</span><span class="pln"> </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">passwd </span></code></li><li class="L1"><code><span class="pun">这里指定了</span><span class="pln">action</span><span class="pun">{</span><span class="kwd">print</span><span class="pln"> $7</span><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="96nl" id="awk内置变量">awk内置变量</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="413y"><ol class="linenums"><li class="L0"><code><span class="pln">ARGC               </span><span class="pun">命令行参数个数</span></code></li><li class="L1"><code><span class="pln">ARGV               </span><span class="pun">命令行参数排列</span></code></li><li class="L2"><code><span class="pln">ENVIRON            </span><span class="pun">支持队列中系统环境变量的使用</span></code></li><li class="L3"><code><span class="pln">FILENAME           awk</span><span class="pun">浏览的文件名</span></code></li><li class="L4"><code><span class="pln">FNR                </span><span class="pun">浏览文件的记录数</span></code></li><li class="L5"><code><span class="pln">FS                 </span><span class="pun">设置输入域分隔符，等价于命令行</span><span class="pln"> </span><span class="pun">-</span><span class="pln">F</span><span class="pun">选项</span></code></li><li class="L6"><code><span class="pln">NF                 </span><span class="pun">浏览记录的域的个数</span></code></li><li class="L7"><code><span class="pln">NR                 </span><span class="pun">已读的记录数</span></code></li><li class="L8"><code><span class="pln">OFS                </span><span class="pun">输出域分隔符</span></code></li><li class="L9"><code><span class="pln">ORS                </span><span class="pun">输出记录分隔符</span></code></li><li class="L0"><code><span class="pln">RS                 </span><span class="pun">控制记录分隔符</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="aa5t" id="统计etcpasswd文件名每行的行号每行的列数对应的完整行内容">统计/etc/passwd:文件名，每行的行号，每行的列数，对应的完整行内容:</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="gbnx"><ol class="linenums"><li class="L0"><code><span class="pln">awk  </span><span class="pun">-</span><span class="pln">F </span><span class="str">':'</span><span class="pln">  </span><span class="str">'{print "filename:" FILENAME ",linenumber:" NR ",columns:" NF ",linecontent:"$0}'</span><span class="pln"> </span><span class="pun">/</span><span class="pln">etc</span><span class="pun">/</span><span class="pln">passwd</span></code></li></ol></pre></div>
</body>
</html>