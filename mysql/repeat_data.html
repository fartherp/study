<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>重复数据处理</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="7vll" id="重复数据处理">重复数据处理</h1><hr><div class="md-section-divider"></div><h2 data-anchor-id="yxrj" id="测试数据">测试数据</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="dezh"><ol class="linenums"><li class="L0"><code><span class="pln">CREATE TABLE person_tbl</span></code></li><li class="L1"><code><span class="pun">(</span></code></li><li class="L2"><code><span class="pln">   first_name CHAR</span><span class="pun">(</span><span class="lit">20</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span></code></li><li class="L3"><code><span class="pln">   last_name CHAR</span><span class="pun">(</span><span class="lit">20</span><span class="pun">)</span><span class="pln"> NOT NULL</span><span class="pun">,</span></code></li><li class="L4"><code><span class="pln">   sex CHAR</span><span class="pun">(</span><span class="lit">10</span><span class="pun">),</span></code></li><li class="L5"><code><span class="pln">   PRIMARY KEY </span><span class="pun">(</span><span class="pln">last_name</span><span class="pun">,</span><span class="pln"> first_name</span><span class="pun">)</span></code></li><li class="L6"><code><span class="pun">);</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="y9um" id="防止表出现重复数据">防止表出现重复数据</h2><div class="md-section-divider"></div><h3 data-anchor-id="84d2" id="insert-into">insert into</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="hoh2"><ol class="linenums"><li class="L0"><code><span class="pln">INSERT INTO person_tbl </span><span class="pun">(</span><span class="pln">last_name</span><span class="pun">,</span><span class="pln"> first_name</span><span class="pun">)</span><span class="pln"> VALUES</span><span class="pun">(</span><span class="pln"> </span><span class="str">'Jay'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Thomas'</span><span class="pun">);</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span class="pun">重复数据出错</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="ghn4" id="insert-ignore-into">insert ignore into</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="s87n"><ol class="linenums"><li class="L0"><code><span class="pln">INSERT IGNORE INTO person_tbl </span><span class="pun">(</span><span class="pln">last_name</span><span class="pun">,</span><span class="pln"> first_name</span><span class="pun">)</span><span class="pln"> VALUES</span><span class="pun">(</span><span class="pln"> </span><span class="str">'Jay'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Thomas'</span><span class="pun">);</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span class="pun">重复数据跳过不出错也不添加</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="9w91" id="过滤重复数据">过滤重复数据</h2><div class="md-section-divider"></div><h3 data-anchor-id="43st" id="group-by">group by</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="1d9j"><ol class="linenums"><li class="L0"><code><span class="pln">SELECT last_name</span><span class="pun">,</span><span class="pln"> first_name FROM person_tbl GROUP BY </span><span class="pun">(</span><span class="pln">last_name</span><span class="pun">,</span><span class="pln"> first_name</span><span class="pun">);</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="rstu" id="distinct">distinct</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="aa0u"><ol class="linenums"><li class="L0"><code><span class="pln">SELECT DISTINCT last_name</span><span class="pun">,</span><span class="pln"> first_name FROM person_tbl ORDER BY last_name</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="eh7g" id="删除重复数据">删除重复数据</h2><div class="md-section-divider"></div><h3 data-anchor-id="05ey" id="alter-ignore-table">alter ignore table</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="k71n"><ol class="linenums"><li class="L0"><code><span class="pln">ALTER IGNORE TABLE person_tbl ADD PRIMARY KEY </span><span class="pun">(</span><span class="pln">last_name</span><span class="pun">,</span><span class="pln"> first_name</span><span class="pun">);</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span class="pun">添加主键删除重复记录</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="7i8o" id="重复数据先拷贝新表再重命名">重复数据先拷贝新表再重命名</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="692k"><ol class="linenums"><li class="L0"><code><span class="pln">CREATE TABLE tmp SELECT last_name</span><span class="pun">,</span><span class="pln"> first_name</span><span class="pun">,</span><span class="pln"> sex FROM person_tbl GROUP BY </span><span class="pun">(</span><span class="pln">last_name</span><span class="pun">,</span><span class="pln"> first_name</span><span class="pun">);</span><span class="pln"> </span></code></li><li class="L1"><code><span class="pln">DROP TABLE person_tbl</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pln">ALTER TABLE tmp RENAME TO person_tbl</span><span class="pun">;</span></code></li></ol></pre></div>
</body>
</html>