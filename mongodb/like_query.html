<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>mongodb模糊查询</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="quse" id="mongodb模糊查询">mongodb模糊查询</h1><div class="md-section-divider"></div><h2 data-anchor-id="65qr" id="使用rockmongo客户端工具进行模糊查询">使用RockMongo客户端工具进行模糊查询</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="9o6v"><ol class="linenums"><li class="L0"><code><span class="pun">{</span><span class="str">"content"</span><span class="pun">:</span><span class="str">"$regex"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"123456"</span><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="yoe5" id="查询包含xxx-1">查询包含XXX</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ac54"><ol class="linenums"><li class="L0"><code><span class="pln">db</span><span class="pun">.</span><span class="pln">getCollection</span><span class="pun">(</span><span class="str">'test'</span><span class="pun">).</span><span class="pln">find</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">/xxx/</span><span class="pun">})</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="s225" id="查询以xxx开头">查询以XXX开头</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="gqbo"><ol class="linenums"><li class="L0"><code><span class="pln">db</span><span class="pun">.</span><span class="pln">getCollection</span><span class="pun">(</span><span class="str">'test'</span><span class="pun">).</span><span class="pln">find</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">/^xxx/</span><span class="pun">})</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="w96y" id="查询以xxx结尾">查询以XXX结尾</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ulwd"><ol class="linenums"><li class="L0"><code><span class="pln">db</span><span class="pun">.</span><span class="pln">getCollection</span><span class="pun">(</span><span class="str">'test'</span><span class="pun">).</span><span class="pln">find</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">/xxx^/</span><span class="pun">})</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="75cb" id="查询忽略大小写">查询忽略大小写</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="6esw"><ol class="linenums"><li class="L0"><code><span class="pln">db</span><span class="pun">.</span><span class="pln">getCollection</span><span class="pun">(</span><span class="str">'test'</span><span class="pun">).</span><span class="pln">find</span><span class="pun">({</span><span class="pln">name</span><span class="pun">:</span><span class="str">/xxx/</span><span class="pln">i</span><span class="pun">})</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="xsne" id="spring中不区分大小写的模糊查询">Spring中不区分大小写的模糊查询</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rtgh"><ol class="linenums"><li class="L0"><code><span class="com">//完全匹配</span></code></li><li class="L1"><code><span class="typ">Pattern</span><span class="pln"> pattern </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">"^王$"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">CASE_INSENSITIVE</span><span class="pun">);</span></code></li><li class="L2"><code><span class="com">//右匹配</span></code></li><li class="L3"><code><span class="typ">Pattern</span><span class="pln"> pattern </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">"^.*王$"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">CASE_INSENSITIVE</span><span class="pun">);</span></code></li><li class="L4"><code><span class="com">//左匹配</span></code></li><li class="L5"><code><span class="typ">Pattern</span><span class="pln"> pattern </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">"^王.*$"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">CASE_INSENSITIVE</span><span class="pun">);</span></code></li><li class="L6"><code><span class="com">//模糊匹配</span></code></li><li class="L7"><code><span class="typ">Pattern</span><span class="pln"> pattern </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">"^.*王.*$"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Pattern</span><span class="pun">.</span><span class="pln">CASE_INSENSITIVE</span><span class="pun">);</span></code></li><li class="L8"><code><span class="typ">Query</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Query</span><span class="pun">.</span><span class="pln">query</span><span class="pun">(</span><span class="typ">Criteria</span><span class="pun">.</span><span class="kwd">where</span><span class="pun">(</span><span class="pln">fieldName</span><span class="pun">).</span><span class="pln">regex</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">));</span><span class="pln"> </span></code></li><li class="L9"><code><span class="typ">List</span><span class="str">&lt;simpleuserinfo&gt;</span><span class="pln"> users </span><span class="pun">=</span><span class="pln"> mongoTemplate</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="pln">query</span><span class="pun">,</span><span class="pln"> </span><span class="typ">SimpleUserInfo</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> classname</span><span class="pun">);</span></code></li><li class="L0"><code><span class="kwd">return</span><span class="pln"> users</span><span class="pun">;</span></code></li></ol></pre></div>
</body>
</html>